<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>‚öîÔ∏è Tower Siege ‚Äî Controller</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="app">
        <!-- Loading State -->
        <div id="loadingScreen" class="screen active">
            <div class="loader-ring"></div>
            <p class="loader-text">Loading MediaPipe...</p>
            <p class="loader-sub">Pose detection model</p>
        </div>

        <!-- Camera + Game View -->
        <div id="gameScreen" class="screen">
            <video id="video" autoplay playsinline muted></video>
            <canvas id="overlay"></canvas>

            <!-- HUD -->
            <div id="hud">
                <div id="teamBadge" class="badge">CONNECTING...</div>
                <div id="pushupCount" class="big-count">0</div>
                <div id="pushupLabel">JUMPS</div>
                <div id="soldiersCount">‚öî 0 soldiers sent</div>
                <div id="angleBar">
                    <div id="angleBarFill"></div>
                </div>
                <div id="angleLabel">BODY ALIGNMENT</div>
                <div id="stateIndicator">‚Äî</div>
            </div>

            <!-- Deploy Mode Badge -->
            <div id="deployBadge" class="deploy-badge">AUTO</div>

            <!-- Head Direction Indicator (manual mode) -->
            <div id="headIndicator" class="head-indicator hidden">
                <div class="head-arrow" id="headArrow">‚¨Ü</div>
                <div class="head-label" id="headLabel">READY</div>
            </div>

            <!-- No Person Warning -->
            <div id="noPersonOverlay" class="no-person-overlay hidden">
                <div class="no-person-icon">üë§‚ùå</div>
                <div class="no-person-text">NO PLAYER DETECTED</div>
                <div class="no-person-timer" id="noPersonTimer">5</div>
                <div class="no-person-sub">Return to frame or game ends!</div>
            </div>

            <!-- Ready Button -->
            <button id="readyBtn" class="ready-btn">TAP WHEN READY</button>

            <!-- Deploy Mode Selector (shows before ready) -->
            <div id="deployModeSelector" class="deploy-mode-selector">
                <div class="mode-title">DEPLOY MODE</div>
                <button id="autoModeBtn" class="mode-btn active" data-mode="auto">
                    ü§ñ AUTO<br><span class="mode-desc">AI sends troops</span>
                </button>
                <button id="manualModeBtn" class="mode-btn" data-mode="manual">
                    üéØ MANUAL<br><span class="mode-desc">Lean to aim</span>
                </button>
            </div>

            <!-- Game Status -->
            <div id="gameStatus" class="game-status hidden"></div>
        </div>

        <!-- Game Over -->
        <div id="overScreen" class="screen">
            <div id="overResult"></div>
            <p id="overStats"></p>
        </div>
    </div>

    <script type="module" src="controller.js"></script>
</body>

</html>
